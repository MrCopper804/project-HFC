<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HFC - Command Center (Admin)</title>
    <style>
        :root { --admin-neon: #ff0055; --bg: #000; }
        body { background: var(--bg); color: white; font-family: sans-serif; padding: 20px; text-align: center; }
        .admin-box { 
            max-width: 400px; margin: 20px auto; background: rgba(255,0,85,0.05); 
            padding: 30px; border-radius: 20px; border: 1px solid var(--admin-neon);
        }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #111; border: 1px solid #333; color: white; border-radius: 8px; box-sizing: border-box;}
        button { width: 100%; padding: 12px; background: var(--admin-neon); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px;}
    </style>
</head>
<body>
    <h1 style="color: var(--admin-neon);">COMMAND CENTER</h1>
    <div class="admin-box">
        <p style="font-size: 12px; color: #888;">TARGET AGENT EMAIL</p>
        <input type="email" id="targetEmail" placeholder="agent@email.com">
        
        <p style="font-size: 12px; color: #888;">GIVE MISSION XP</p>
        <input type="number" id="giveXP" placeholder="Amount (e.g. 500)">
        
        <p style="font-size: 12px; color: #888;">GIVE HFC COINS</p>
        <input type="number" id="giveCoins" placeholder="Amount (e.g. 50)">
        
        <button id="updateAgent">UPDATE AGENT DATA</button>
        <p id="adminStatus" style="font-size: 12px; margin-top: 15px;"></p>
    </div>
    <a href="lobby.html" style="color: #555; text-decoration: none; font-size: 12px;">EXIT COMMAND CENTER</a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, where, getDocs, updateDoc, doc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { /* Your Config */ };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.getElementById('updateAgent').onclick = async () => {
            const email = document.getElementById('targetEmail').value;
            const xp = parseInt(document.getElementById('giveXP').value) || 0;
            const coins = parseInt(document.getElementById('giveCoins').value) || 0;
            const status = document.getElementById('adminStatus');

            status.innerText = "Searching for agent...";

            // Find user by email
            const q = query(collection(db, "users"), where("email", "==", email));
            const querySnap = await getDocs(q);

            if (!querySnap.empty) {
                const userDoc = querySnap.docs[0];
                await updateDoc(doc(db, "users", userDoc.id), {
                    score: increment(xp),
                    coins: increment(coins)
                });
                status.innerText = "Target updated successfully!";
                status.style.color = "#64ffda";
            } else {
                status.innerText = "Agent not found!";
                status.style.color = "#ff4d4d";
            }
        };
    </script>
</body>
</html>
