<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HFC - Command Center</title>
    <style>
        :root { --admin: #ff0055; --bg: #000; --glass: rgba(255, 0, 85, 0.05); }
        body { 
            background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 20px; display: flex; justify-content: center;
            background-image: linear-gradient(135deg, #20010c 0%, #000 100%);
        }
        .admin-panel {
            background: rgba(10, 10, 10, 0.9); border: 1px solid var(--admin);
            padding: 30px; border-radius: 25px; width: 100%; max-width: 400px;
            box-shadow: 0 0 30px rgba(255, 0, 85, 0.2);
        }
        h2 { color: var(--admin); letter-spacing: 3px; text-align: center; }
        .input-group { margin-bottom: 20px; }
        label { font-size: 11px; color: #888; display: block; margin-bottom: 5px; }
        input {
            width: 100%; padding: 12px; background: #111; border: 1px solid #333;
            border-radius: 10px; color: white; box-sizing: border-box; outline: none;
        }
        input:focus { border-color: var(--admin); }
        .action-btn {
            width: 100%; padding: 15px; background: var(--admin); color: white;
            border: none; border-radius: 10px; font-weight: bold; cursor: pointer;
            transition: 0.3s;
        }
        .action-btn:active { transform: scale(0.95); }
        #status { font-size: 12px; margin-top: 15px; text-align: center; min-height: 20px; }
    </style>
</head>
<body>

<div class="admin-panel">
    <h2>COMMAND CENTER</h2>
    
    <div class="input-group">
        <label>TARGET AGENT EMAIL</label>
        <input type="email" id="targetEmail" placeholder="agent@email.com">
    </div>

    <div class="input-group">
        <label>ADD MISSION XP (+/-)</label>
        <input type="number" id="xpAmount" value="0">
    </div>

    <div class="input-group">
        <label>ADD HFC COINS (+/-)</label>
        <input type="number" id="coinAmount" value="0">
    </div>

    <button class="action-btn" id="execBtn">EXECUTE UPDATE</button>
    <div id="status"></div>

    <a href="lobby.html" style="display:block; text-align:center; color:#555; text-decoration:none; font-size:12px; margin-top:20px;">BACK TO LOBBY</a>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs, doc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBIT9JgQ8t044EbgeGSGWNfh-CgNrWajN8",
        authDomain: "hfc-academy.firebaseapp.com",
        projectId: "hfc-academy",
        storageBucket: "hfc-academy.firebasestorage.app",
        messagingSenderId: "84006497196",
        appId: "1:84006497196:web:be0d33ae2db19dd77ae809"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    document.getElementById('execBtn').onclick = async () => {
        const email = document.getElementById('targetEmail').value;
        const xp = parseInt(document.getElementById('xpAmount').value);
        const coins = parseInt(document.getElementById('coinAmount').value);
        const status = document.getElementById('status');

        if(!email) { status.innerText = "Email is required!"; return; }

        status.innerText = "Accessing Database...";
        status.style.color = "white";

        try {
            const q = query(collection(db, "users"), where("email", "==", email));
            const snap = await getDocs(q);

            if (!snap.empty) {
                const userDoc = snap.docs[0];
                await updateDoc(doc(db, "users", userDoc.id), {
                    score: increment(xp),
                    coins: increment(coins)
                });
                status.innerText = "COMMAND EXECUTED SUCCESSFULLY";
                status.style.color = "#64ffda";
            } else {
                status.innerText = "AGENT NOT FOUND";
                status.style.color = "#ff4d4d";
            }
        } catch (e) {
            status.innerText = "ACCESS DENIED / ERROR";
            console.error(e);
        }
    }
</script>
</body>
</html>
